#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Festival TTS —Å–µ—Ä–≤–µ—Ä–∞
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–∑–≤—É—á–∫–∏ –∫–Ω–æ–ø–æ–∫ –≤ SmartScroll

echo "üé§ –ó–∞–ø—É—Å–∫ Festival TTS —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –æ–∑–≤—É—á–∫–∏ –∫–Ω–æ–ø–æ–∫..."

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å Festival
cd "/Users/aliserromankul/Desktop/smartscrolling/smart_scroll2/#2/festival"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø—É—â–µ–Ω –ª–∏ —É–∂–µ —Å–µ—Ä–≤–µ—Ä
if pgrep -f "festival_server" > /dev/null; then
    echo "‚úÖ Festival —Å–µ—Ä–≤–µ—Ä —É–∂–µ –∑–∞–ø—É—â–µ–Ω"
else
    echo "üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º Festival —Å–µ—Ä–≤–µ—Ä..."
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º Festival —Å–µ—Ä–≤–µ—Ä –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
    ./festival_server_fixed.sh -p 1314 &
    
    # –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    sleep 3
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
    if pgrep -f "festival_server" > /dev/null; then
        echo "‚úÖ Festival —Å–µ—Ä–≤–µ—Ä —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 1314"
    else
        echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å Festival —Å–µ—Ä–≤–µ—Ä"
        echo "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é: ./festival_server_fixed.sh -p 1314"
    fi
fi

# –ó–∞–ø—É—Å–∫–∞–µ–º –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Festival TTS
echo "üåê –ó–∞–ø—É—Å–∫–∞–µ–º –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Festival TTS..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø—É—â–µ–Ω –ª–∏ —É–∂–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
if pgrep -f "web_server.py" > /dev/null; then
    echo "‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Festival TTS —É–∂–µ –∑–∞–ø—É—â–µ–Ω"
else
    echo "üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å..."
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
    python3 web_server.py &
    
    # –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    sleep 3
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
    if pgrep -f "web_server.py" > /dev/null; then
        echo "‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Festival TTS –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:5001"
    else
        echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Festival TTS"
        exit 1
    fi
fi

# –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä –æ–∑–≤—É—á–∫–∏ –∫–Ω–æ–ø–æ–∫
echo "üîä –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä –æ–∑–≤—É—á–∫–∏ –∫–Ω–æ–ø–æ–∫..."

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é web
cd "/Users/aliserromankul/Desktop/smartscrolling/smart_scroll2/web"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø—É—â–µ–Ω –ª–∏ —É–∂–µ —Å–µ—Ä–≤–µ—Ä –æ–∑–≤—É—á–∫–∏ –∫–Ω–æ–ø–æ–∫
if pgrep -f "button-audio-server.py" > /dev/null; then
    echo "‚úÖ –°–µ—Ä–≤–µ—Ä –æ–∑–≤—É—á–∫–∏ –∫–Ω–æ–ø–æ–∫ —É–∂–µ –∑–∞–ø—É—â–µ–Ω"
else
    echo "üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä –æ–∑–≤—É—á–∫–∏ –∫–Ω–æ–ø–æ–∫..."
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä –æ–∑–≤—É—á–∫–∏ –∫–Ω–æ–ø–æ–∫ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
    python3 button-audio-server.py &
    
    # –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    sleep 2
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
    if pgrep -f "button-audio-server.py" > /dev/null; then
        echo "‚úÖ –°–µ—Ä–≤–µ—Ä –æ–∑–≤—É—á–∫–∏ –∫–Ω–æ–ø–æ–∫ –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8001"
    else
        echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –æ–∑–≤—É—á–∫–∏ –∫–Ω–æ–ø–æ–∫"
        echo "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é: python3 button-audio-server.py"
    fi
fi

echo ""
echo "üéâ Festival TTS —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!"
echo "üìç Festival —Å–µ—Ä–≤–µ—Ä: localhost:1314"
echo "üåê –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: http://localhost:5001"
echo "üîä –°–µ—Ä–≤–µ—Ä –æ–∑–≤—É—á–∫–∏ –∫–Ω–æ–ø–æ–∫: http://localhost:8001"
echo "üé§ –û–∑–≤—É—á–∫–∞ –∫–Ω–æ–ø–æ–∫ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö SmartScroll"
echo ""
echo "–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:"
echo "pkill -f festival_server"
echo "pkill -f web_server.py"
echo "pkill -f button-audio-server.py"
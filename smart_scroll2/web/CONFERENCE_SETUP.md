# Smart Scroll Video Conference Setup

## Описание

Интегрированное решение для видеоконференций на базе Twilio Video с современным интерфейсом Smart Scroll.

## Возможности

- ✅ Реальные видеоконференции через Twilio Video
- ✅ Управление микрофоном и камерой
- ✅ Демонстрация экрана
- ✅ Картинка в картинке (PiP)
- ✅ Адаптивный интерфейс
- ✅ Автоматическое определение доминирующего спикера
- ✅ Управление приоритетом видео

## Быстрый старт

### 1. Установка зависимостей

```bash
cd web
npm install
```

### 2. Настройка Twilio

1. Зарегистрируйтесь в [Twilio Console](https://console.twilio.com/)
2. Создайте новый API Key в разделе "API Keys & Tokens"
3. Скопируйте `env.example` в `.env` и заполните:

```bash
cp env.example .env
```

Заполните `.env` файл:
```
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_API_KEY=SKxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_API_SECRET=your_api_secret_here
PORT=3000
```

### 3. Запуск сервера

```bash
npm start
```

Или для разработки:
```bash
npm run dev
```

### 4. Открытие приложения

Откройте браузер и перейдите по адресу:
```
http://localhost:3000
```

## Структура файлов

```
web/
├── conference-template-new.html    # Основной HTML интерфейс
├── twilio-token-server.js         # Сервер для генерации токенов
├── package.json                   # Зависимости Node.js
├── env.example                    # Пример конфигурации
└── CONFERENCE_SETUP.md           # Данная инструкция
```

## API Endpoints

### GET /token?identity=username
Генерирует токен доступа для Twilio Video

**Параметры:**
- `identity` - имя пользователя

**Ответ:** JWT токен

### GET /room/:roomName
Получает информацию о комнате

**Параметры:**
- `roomName` - название комнаты

**Ответ:** JSON с информацией о комнате

### GET /health
Проверка состояния сервера

**Ответ:** JSON со статусом сервера

## Использование

### Создание комнаты

1. Нажмите "Создать комнату"
2. Введите название комнаты и ваше имя
3. Нажмите "Создать"

### Присоединение к комнате

1. Нажмите "Присоединиться к комнате"
2. Введите название комнаты и ваше имя
3. Нажмите "Присоединиться"

### Управление медиа

- **Микрофон**: Кнопка с иконкой микрофона
- **Камера**: Кнопка с иконкой камеры
- **Демонстрация экрана**: Кнопка с иконкой экрана
- **PiP**: Кнопка для картинки в картинке

## Технические детали

### Twilio Video SDK

Используется Twilio Video SDK версии 2.31.0 с поддержкой:
- WebRTC для P2P соединений
- Адаптивное качество видео
- Автоматическое переключение доминирующего спикера
- Simulcast для оптимизации пропускной способности

### Браузерная поддержка

- Chrome 60+
- Firefox 55+
- Safari 11+
- Edge 79+

### Безопасность

- Токены доступа имеют ограниченное время жизни (4 часа)
- Используется HTTPS в продакшене
- Валидация входных данных

## Устранение неполадок

### Ошибка "Не удалось получить токен доступа"

1. Проверьте правильность переменных окружения в `.env`
2. Убедитесь, что Twilio Account SID и API Key корректны
3. Проверьте, что API Secret соответствует API Key

### Ошибка "Не удалось получить доступ к камере"

1. Разрешите доступ к камере и микрофону в браузере
2. Убедитесь, что используете HTTPS (или localhost)
3. Проверьте, что камера не используется другим приложением

### Проблемы с подключением

1. Проверьте интернет-соединение
2. Убедитесь, что порт 3000 не заблокирован файрволом
3. Проверьте логи сервера в консоли

## Разработка

### Структура кода

- `ConferenceApp` - основной класс приложения
- `participantConnected()` - обработка подключения участников
- `trackPublished()` - обработка медиа треков
- `setActiveParticipant()` - управление активным участником

### Добавление новых функций

1. Обновите HTML интерфейс
2. Добавьте обработчики в `ConferenceApp`
3. Обновите серверную логику при необходимости

## Лицензия

MIT License - см. файл LICENSE для деталей.